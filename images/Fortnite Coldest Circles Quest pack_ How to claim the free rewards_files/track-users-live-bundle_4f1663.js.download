var TrackUsersLive=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function i(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}r.r(t),r.d(t,"getUrlParameter",(function(){return i})),r.d(t,"sendPageViewRequest",(function(){return a})),r.d(t,"getUniqueSessionId",(function(){return o})),r.d(t,"log_page_view",(function(){return c}));var n=!0;window.onmousemove=function(){n=!0},window.onscroll=function(){n=!0};function o(){var e=getCookie("KEEDA_SESSION_ID");if(e)return console.log("affiliate: returning existing session ID"),e;console.log("affiliate: returning new session ID");var t,r=((t=(new Date).getTime()).toString(32)+"-xxxxxxxx-6xxx-4xxx-yxxx-xxxxxxxxxxx").replace(/[xy]/g,(function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?r:3&r|8).toString(16)})),i=new Date;return i.setMinutes(i.getMinutes()+60),setCookie("KEEDA_SESSION_ID",r,i),r}function s(){if("undefined"!=typeof trackUsersLiveObject&&n){var e=getCookie("_ga");trackUsersLiveObject&&trackUsersLiveObject.postTitle&&e&&void 0!==e&&pureJSAjaxGet(trackUsersLiveObject.analyticsURL+"/live2/set-live-user/"+trackUsersLiveObject.postTitle+"/"+trackUsersLiveObject.postURL+"/"+e,(function(e){e=JSON.parse(e),console.log("live track:",e.status)}),(function(e){console.log(e)}))}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"!=typeof trackUsersLiveObject&&"Topicpage"!=pageType&&(n||e)){window.location.href;var r=getCookie("_ga"),s=i("key1"),c=i("key2"),u=i("key3"),v=i("key4"),l=window.location.search,d=o(),f="true",p="uri="+encodeURIComponent(trackUsersLiveObject.canonicalURL)+"&userIdentifier="+r+"&author_id="+trackUsersLiveObject.authorID+"&revenue_share="+trackUsersLiveObject.revenueShare+"&query_string="+encodeURIComponent(l)+"&session_id="+d+"&key1="+s+"&key2="+c+"&key3="+u+"&key4="+v+"&post_id="+trackUsersLiveObject.postID+"&post_section="+trackUsersLiveObject.postSection+"&pageType="+trackUsersLiveObject.pageType+"&post_type="+trackUsersLiveObject.pt+"&tt_id_json="+trackUsersLiveObject.tt_id_json+"&published_date="+trackUsersLiveObject.published_date+"&first_published_date="+trackUsersLiveObject.first_published_date+"&lang="+trackUsersLiveObject.lang+"&tt_id_category="+trackUsersLiveObject.tt_id_category+"&tt_id_section="+trackUsersLiveObject.tt_id_section+"&update_reads="+f+"&page_view="+t;"1"===trackUsersLiveObject.isTimeless&&(p+="&isTimeless=true");var g=!1;if("pushnotifopera"==s){if(g)return;g=!0,a(p)}document.addEventListener("scroll",(function(){g||(g=!0,a(p))}))}}function a(e,t){var r=t||trackUsersLiveObject.ingestionServer;pureJSAjaxPostWithData(r+"/logviewedpage?"+e,e,(function(e){try{e=JSON.parse(e),console.log("page view log:",e.status)}catch(e){console.error("Page view log parse err:",e)}}),(function(e){console.log(e)}),!0)}function u(e){if("undefined"!=typeof trackUsersLiveObject&&"boolean"==typeof e){var t={send_to:trackUsersLiveObject.ga4_id,sk_version:trackUsersLiveObject.release,non_interaction:!0,withInteraction:e};trackUsersLiveObject.pageType&&(t.page_type=trackUsersLiveObject.pageType),trackUsersLiveObject.pt&&(t.post_type=trackUsersLiveObject.pt),trackUsersLiveObject.authorID&&(t.author=trackUsersLiveObject.authorID),trackUsersLiveObject.revenueShare&&(t.rev_share=trackUsersLiveObject.revenueShare),trackUsersLiveObject.lang&&(t.lang=trackUsersLiveObject.lang),trackUsersLiveObject.tt_id_category&&(t.tt_id_category=trackUsersLiveObject.tt_id_category),trackUsersLiveObject.postID&&(t.post_id=trackUsersLiveObject.postID),trackUsersLiveObject.postSection&&(t.post_section=trackUsersLiveObject.postSection);var r=getCookie("keeda-session-uuid");r&&(t["keeda-session-uuid"]=r);var i=getCookie("fw_ID");i>0&&(t.loggedIn_user_id=i),gtag("event","log_page_view",t)}}console.log("Track live user"),s(),setInterval(s,6e4),setInterval((function(){n=!1}),3e4),"undefined"!=typeof trackUsersLiveObject&&"video"!=trackUsersLiveObject.pt&&(c(!1,!0),u(!1)),window.addEventListener("DOMContentLoaded",(function(){if("undefined"!=typeof trackUsersLiveObject){var e=document.querySelector("#article-content");if(e){var t=e.getBoundingClientRect();if(t){var r=trackUsersLiveObject.isMobile?1500:1200,i=trackUsersLiveObject.isMobile?600:1200,n=t.top+i,o=t.height-i,s={},a=function(e,t){var r;return function(){r||(r=!0,setTimeout((function(){e(),r=!1}),t))}}((function(){var e=window.pageYOffset-n,t=Math.floor(e/r);if(t>4){var i=2*r,v=e-4*r;t=4+Math.floor(v/i)}if(e<o&&t>1&&!s[t])for(var l=2;l<=t&&l<=5;l++)s[l]||(s[l]=!0,console.log("Logging page-view in GA"),c(!1),u(!0));Object.keys(s).length>=4&&document.removeEventListener("scroll",a)}),500);document.addEventListener("scroll",a)}}}}))}]);